{% extends "layout.html" %}

{% block title %}All Homework - Homework Hub{% endblock %}

{% block content %}
<main class="container py-5">
  <h2 class="text-primary mb-4">ðŸ“š All Homework</h2>
  <ul class="list-group" id="all-homework-list">
    <li class="list-group-item">Loading homework...</li>
  </ul>
</main>
{% endblock %}

{% block scripts %}
<script>
  // Mouse background parallax effect
  const bgIcons = document.querySelectorAll('.bg-icon');
  window.addEventListener('mousemove', (e) => {
    const centerX = window.innerWidth / 2;
    const centerY = window.innerHeight / 2;
    bgIcons.forEach((icon, index) => {
      const intensity = (index + 1) * 5;
      const moveX = (e.clientX - centerX) / intensity;
      const moveY = (e.clientY - centerY) / intensity;
      icon.style.transform = `translate(${moveX}px, ${moveY}px)`;
    });
  });

  // Firebase setup and fetching homework data
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const list = document.getElementById("all-homework-list");

  db.collection("homeworks")
    //.orderBy("date", "desc")
    .get()
    .then(querySnapshot => {
      list.innerHTML = "";
      if (querySnapshot.empty) {
        list.innerHTML = "<li class='list-group-item'>No homework found.</li>";
        return;
      }

      querySnapshot.forEach(doc => {
        const data = doc.data();
        const subject = data.subject || "No Subject";
        const task = data.task || data.details || data.description || "No Task Provided";

        const li = document.createElement("li");
        li.className = "list-group-item";
        li.textContent = `${subject}: ${task}`;
        list.appendChild(li);
      });
    })
    .catch(error => {
      console.error("Error fetching homework:", error);
      list.innerHTML = `<li class="list-group-item text-danger">Error loading homework: ${error.message}</li>`;
    });
</script>
{% endblock %}
